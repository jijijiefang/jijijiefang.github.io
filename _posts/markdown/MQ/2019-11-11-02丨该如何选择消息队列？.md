---
layout:     post
title:      "MQ-02丨该如何选择消息队列？"
date:       2019-11-11 17:51:34
author:     "jiefang"
header-style: text
tags:
    - MQ
---
# 02丨该如何选择消息队列？

## 消息队列选型标准
- 必须是开源的产品
- 必须是近年来比较流行并且有一定社区活跃度的产品

作为一款及格的消息队列产品，必须具备的几个特性包括：
- 消息的可靠传递：确保不丢消息；
- Cluster：支持集群，确保不会因为某个节点宕机导致服务不可用，当然也不能丢消息；
- 性能：具备足够好的性能，能满足绝大多数场景的性能要求。

## 可供选择的消息队列产品
### RabbitMQ
**优势**：
- RabbitMQ 是一个相当轻量级的消息队列，非常容易部署和使用
- 号称是世界上使用最广泛的开源消息队列
- 特色的功能是支持非常灵活的路由配置，和其他消息队列不同的
是，它在生产者（Producer）和队列（Queue）之间增加了一个 Exchange 模块。

**不足**：
- RabbitMQ 对消息堆积的支持并不好，当大量消息积压的时候，会导致 RabbitMQ 的性能急剧下降。
- RabbitMQ 的性能比较差，每秒钟可以处理几万到十几万条消息
- RabbitMQ 使用的编程语言 Erlang，难以扩展和二次开发。

### RocketMQ
**优势**：
- RocketMQ 有着不错的性能，稳定性和可靠性；
- RocketMQ 使用 Java 语言开发，容易扩展或者二次开发。
- RocketMQ 对在线业务的响应时延做了很多的优化，级别可以毫秒级的响应，**如果应用场景很在意响应时延，那应该选择使用 RocketMQ**。
- RocketMQ 的性能比 RabbitMQ 要高一个数量级，每秒钟大概能处理几十万条消息。

**不足**：
- 作为国产的消息队列，相比国外的比较流行的同类产品，在国际上还没有那么流行，与周边生态系统的集成和兼容程度要略逊一筹。

### Kafka
当下的Kafka 已经发展为一个非常成熟的消息队列产品，无论在数据可靠性、稳定性和功能特性等方面都可以满足绝大多数场景的需求
**Kafka 与周边生态系统的兼容性是最好的没有之一，尤其在大数据和流计算领域，几乎所有的相关开源软件系统都会优先支持 Kafka。**
Kafka 使用 Scala 和 Java 语言开发，设计上大量使用了批量和异步的思想，
这种设计使得Kafka 能做到超高的性能，Kafka的性能，尤其是异步收发的性能，是三者中最好的，但与RocketMQ并没有量级上的差异，大约每秒钟可以处理几十万条消息。

Kafka 这种异步批量的设计带来的问题是，它的同步收发消息的响应时延比较高，因为当客户端发送一条消息的时候，Kafka并不会立即发送出去，而是要等一会儿攒一批再发送，在它的Broker中，很多地方都会使用这种“先攒一波再一起处理”的设计。当你的业务场景中，每秒钟消息数量没有那么多的时候，Kafka 的时延反而会比较高。所以，**Kafka不太适合在线业务场景**。
