---
layout:     post
title:      "Java类加载"
date:       2019-10-28 00:00:00
author:     "jiefang"
header-style: text
tags:
    - JVM
---
# Java类加载

## Java类加载过程
![image](https://s2.ax1x.com/2019/11/07/MAcYPU.png)
加载->[验证->准备->解析]->初始化
### 加载
通过一个类的完全限定查找此类字节码文件，并利用字节码文件创建一个**Class对象**。

### 验证
确保Class文件的字节流中包含信息符合当前虚拟机要求，不会危害虚拟机自身安全。主要包括四种验证：
- 文件格式验证
- 元数据验证
- 字节码验证
- 符号引用验证。

### 准备
**为类变量**(即static修饰的字段变量)**分配内存并且设置该类变量的初始值**即0(如static int i=5;这里只将i初始化为0，至于5的值将在初始化时赋值)，这里不包含用final修饰的static，因为final在编译的时候就会分配了，注意这里不会为实例变量分配初始化，类变量会分配在方法区中，而实例变量是会随着对象一起分配到Java堆中。
### 解析
将常量池中的**符号引用替换为直接引用**的过程。
包括：
- 类或接口的解析；
- 字段解析；
- 类方法解析；
- 接口方法解析。

### 初始化
类加载最后阶段，若该类具有超类，则对其进行初始化，**执行静态初始化器和静态初始化成员变量**(如前面只初始化了默认值的static变量将会在这个阶段赋值，成员变量也将被初始化)。

## 类加载器

### 引导类加载器(Bootstrap ClassLoader)

### 扩展类加载器(Extension ClassLoader)

### 系统类加载器(System ClassLoader)

